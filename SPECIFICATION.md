# 規格書：前端字幕截圖工具（模式 1 + 模式 2）

## 1. 系統架構

- **運行環境**：純前端（HTML + CSS + JavaScript）
- **部署平台**：GitHub Pages（靜態網站）

### 核心技術

- `<video>` 元素播放影片
- Canvas API 擷取截圖
- 字幕檔解析（支援 .srt / .vtt）
- CSS Flex/Grid 排版
- html2canvas（將模式 2 的左右分欄輸出成一張圖）

---

## 2. 功能清單

### 2.1 影片載入

**支援：**
- 本地檔案上傳（MP4/WebM）
- MP4 直連網址輸入（需可跨域訪問）
- 載入後顯示影片預覽（可播放、快轉）

### 2.2 字幕上傳與解析

- 上傳 `.srt` 或 `.vtt` 檔案
- 前端解析成：
  ```javascript
  [
    { "start": 0, "end": 2.5, "text": "字幕內容1" },
    { "start": 2.5, "end": 5.0, "text": "字幕內容2" }
  ]
  ```
- 支援 UTF-8 中文/英文

### 2.3 截圖時間設定

- **欄位**：起始時間 (`hh:mm:ss`)、截圖長度（秒，預設 30）
- 按下「擷取」後：
  - 找出該時間段內的字幕
  - 在起始時間抓一張影片截圖

### 2.4 模式切換

- **模式 1（疊加字幕）**
  - 把字幕合成到影片截圖上（Canvas 繪製）
  - 自動換行、支援字幕背景黑底半透明
- **模式 2（分欄排版）**
  - 左邊 `<img>` 顯示截圖
  - 右邊 `<div>` 顯示字幕段落（含時間戳）
  - 可滾動或換行排版
  - 匯出時用 `html2canvas` 合成一張 PNG

### 2.5 圖片下載

- **模式 1**：直接下載 Canvas 生成的 PNG
- **模式 2**：下載 `html2canvas` 合成的 PNG

---

## 3. UI 設計

### 3.1 頁面區塊

- **影片區**
  - `[上傳影片檔按鈕]`
  - `[輸入影片網址欄位]`
  - `<video>` 播放器
- **字幕區**
  - `[上傳字幕檔按鈕]`
  - 顯示字幕檔資訊（檔名、總時長）
- **擷取設定區**
  - 起始時間輸入 (`hh:mm:ss`)
  - 擷取時長輸入（秒）
  - `[擷取截圖]` 按鈕
- **模式切換**
  - 單選按鈕：
    - 模式 1：疊加字幕
    - 模式 2：分欄字幕
- **輸出區**
  - 預覽結果
  - `[下載圖片]` 按鈕

---

## 4. 截圖與字幕處理邏輯

### 4.1 擷取截圖

- 設定 `video.currentTime = 起始時間`
- 等待 `seeked` 事件後：
  ```javascript
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  ```

### 4.2 擷取字幕

- 遍歷字幕陣列，篩選：
  ```javascript
  startTime <= subtitle.start < endTime
  ```
- 輸出為多行文字

### 4.3 模式 1（Canvas 繪製字幕）

- 設定字型、顏色、位置
- 背景黑底透明框
- 支援多行字幕

### 4.4 模式 2（HTML 排版）

- Flexbox 佈局：
  ```css
  .container {
    display: flex;
    gap: 20px;
  }
  .left { flex: 1; }
  .right { flex: 1; }
  ```
- 右側字幕：
  ```
  [00:00:30 - 00:00:32] 字幕內容1
  [00:00:33 - 00:00:35] 字幕內容2
  ```

---

## 5. 未來擴充

- 支援 YouTube API + 後端截圖
- 支援多時間點批次擷取
- 支援自訂字幕樣式（字型、大小、顏色）
- 支援多語字幕切換
